<%= form_for @ingredient do |f| %>
  <%= f.label :name %>
  <%= f.text_field :name %>
  <%= hidden_field_tag :connection_names %>
  <%= autocomplete_field_tag 'connection_name_field', '', autocomplete_ingredient_name_ingredients_path , :size => 75 %>
  <%= select_tag "connection_type" , options_for_select(connection_type_list.collect { |c| [c,c] }) %>
  <a href="#" onclick="addConnection()">Add Connection</a>
  <h3>Connections</h3>
  <ul class="connection-list">
    <% @ingredient.connections.each do |ingredient| %>
      <li><%= ingredient.name %> : <%= ingredient.connection_strength_to(@ingredient).connection_type %></li>
    <% end %>

  </ul>


  <%= f.submit %>
<% end %>

<script>
  $(document).ready(function(){
    addConnection = function(){
      var existing = $("#connection_names").val();
      if(existing != ""){
        existing += ","
      }
      var connection_name = $("#connection_name_field").val();
      var connection_type = $("#connection_type").val();
      $("#connection_names").val(existing + connection_name +":"+connection_type);
      $("ul.connection-list").append("<li>"+connection_name+" : " + connection_type +"</li>");
      $("#connection_name_field").val("");
    }
  });
  
</script>